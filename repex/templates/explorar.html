{% extends 'base.html' %}
{% load static news_extras %}
{% block title %}
  Explorar projetos
{% endblock %}

{% block content %}
  {% if query %}
    <div class="carousel-shell mb-5">
      <h4 style="color: blue;">Projetos correspondentes:</h4>
      <div id="ajax_projetos">
        {% include 'partials/_ajax_projetos.html' %}
      </div>
    </div>

    <div class="carousel-shell mb-5">
      <h4 style="color: blue;">Notícias correspondentes:</h4>
      <div id="ajax_noticias">
        {% include 'partials/_ajax_noticias.html' %}
      </div>
    </div>
  {% endif %}

  <div class="carousel-shell mb-5">
    <h4 style="color: blue;">Conheça projetos:</h4>
    <div class="carousel-viewport">
      <div class="carousel-track w-100" id="cardTrack">
        {% for projeto in projetos_random %}
          <div class="card-item">
            {% include 'partials/_card.html' %}
          </div>
        {% endfor %}
      </div>
    </div>

    <button class="btn btn-light carousel-control carousel-prev" id="prevBtn" style="color: blue;" aria-label="Anterior">‹</button>
    <button class="btn btn-light carousel-control carousel-next" id="nextBtn" style="color: blue;" aria-label="Próximo">›</button>
  </div>

  <div id="newsCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
    <h4 style="color: blue;">Notícias relevantes:</h4>
    <div class="carousel-inner">
      {% for group in noticias_random|chunks:3 %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">
          <div class="notice-shell row g-1 d-flex">
            <div class="col-md-6 col-lg-6 col-sm-12">
              {% if group.0.id %}
                <a href="{% url 'noticia_detail' group.0.id %}" class="text-decoration-none">
                  <div class="notice-card h-100 d-flex"
                    style="background-image: url('{% if group.0.imagem %}
                      {{ group.0.imagem.url }}
                    {% else %}
                      {% static 'imgs/placeholder.webp' %}
                    {% endif %}');">
                    <span class="notice-label">
                      {% if group.0 %}
                        {{ group.0.area_conhecimento }}
                      {% else %}
                        Área de conhecimento
                      {% endif %}
                    </span>
                    <h4 class="m-auto p-5" style="color: orange;">
                      {% if group.0 %}
                        {{ group.0.titulo }}
                      {% else %}
                        Últimas notícias:
                      {% endif %}
                    </h4>
                  </div>
                </a>
              {% endif %}
            </div>

            <div class="col-md-6 col-lg-6 col-sm-12">
              <div class="row d-flex flex-column" style="height: 100%;">
                <div class="col-lg-12 col-md-12 col-sm-12 flex-grow-1 mb-1">
                  {% if group.1.id %}
                    <a href="{% url 'noticia_detail' group.1.id %}" class="text-decoration-none">
                      <div class="notice-card h-100 d-flex"
                        style="background-image: url('{% if group.1.imagem %}
                          {{ group.1.imagem.url }}
                        {% else %}
                          {% static 'imgs/placeholder.webp' %}
                        {% endif %}');">
                        <span class="notice-label">
                          {% if group.1 %}
                            {{ group.1.area_conhecimento }}
                          {% else %}
                            Área de conhecimento
                          {% endif %}
                        </span>
                        <h4 class="m-auto p-5" style="color: orange;">
                          {% if group.1 %}
                            {{ group.1.titulo }}
                          {% else %}
                            Últimas notícias:
                          {% endif %}
                        </h4>
                      </div>
                    </a>
                  {% endif %}
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 flex-grow-1">
                  {% if group.2.id %}
                    <a href="{% url 'noticia_detail' group.2.id %}" class="text-decoration-none">
                      <div class="notice-card h-100 d-flex"
                        style="background-image: url('{% if group.2.imagem %}
                          {{ group.2.imagem.url }}
                        {% else %}
                          {% static 'imgs/placeholder.webp' %}
                        {% endif %}');">
                        <span class="notice-label">
                          {% if group.2 %}
                            {{ group.2.area_conhecimento }}
                          {% else %}
                            Área de conhecimento
                          {% endif %}
                        </span>
                        <h4 class="m-auto p-5" style="color: orange;">
                          {% if group.2 %}
                            {{ group.2.titulo }}
                          {% else %}
                            Últimas notícias:
                          {% endif %}
                        </h4>
                      </div>
                    </a>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <button class="btn btn-light carousel-control carousel-prev" data-bs-target="#newsCarousel" data-bs-slide="prev" style="color: blue;" aria-label="Anterior">‹</button>
    <button class="btn btn-light carousel-control carousel-next" data-bs-target="#newsCarousel" data-bs-slide="next" style="color: blue;" aria-label="Próximo">›</button>
  </div>
{% endblock %}
